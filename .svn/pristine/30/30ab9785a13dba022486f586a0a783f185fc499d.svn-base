{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "%config InlineBackend.figure_format = 'svg'\n",
    "import os\n",
    "try:\n",
    "    import Image\n",
    "except ImportError:\n",
    "    from PIL import Image\n",
    "import cv2\n",
    "import numpy as np\n",
    "import pytesseract\n",
    "from matplotlib import pyplot as plt\n",
    "import math\n",
    "from math import radians, degrees\n",
    "from skewManager import imgproc\n",
    "from skewManager.common import ROTATION, SKEW_X, SKEW_Y, DIRECTION_HORIZONTAL, DIRECTION_VERTICAL\n",
    "from tabledetect import detectTable\n",
    "import pandas as pd\n",
    "import json\n",
    "from BaiduAipOcr import BaiduAipOcr\n",
    "\n",
    "\n",
    "\n",
    "tempout = \"temp/\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "def LineToArea(lines):\n",
    "    area = []\n",
    "    if len(lines) <= 1:\n",
    "        return area\n",
    "    for i in range(len(lines)-1):\n",
    "        area.append((lines[i], lines[i+1]))\n",
    "    return area\n",
    "\n",
    "\n",
    "def imgtotable(img,rows,colums,debug=False):\n",
    "    ocrclient = BaiduAipOcr()\n",
    "    tablelist = [[\"\" for col in range(0,len(colums))] for row in range(0,len(rows))]\n",
    "    cloumarea = LineToArea(colums)\n",
    "    rowsarea = LineToArea(rows)\n",
    "    #print(tablelist)\n",
    "    for row, (ystart,yend) in enumerate(rowsarea):\n",
    "        \n",
    "        print(\"行{}：\".format(row),end=\" \")\n",
    "        for colum,(xstart,xend) in enumerate(cloumarea):\n",
    "            roiimg = img[ystart:yend,\n",
    "                  xstart:xend]\n",
    "\n",
    "\n",
    "            if debug:\n",
    "                \n",
    "                cv2.imwrite(\"testimage/{}{}.jpg\".format(row,colum),roiimg)\n",
    "\n",
    "            try:\n",
    "                print(\"列{}：\".format(colum),end=\" \")\n",
    "                if debug:\n",
    "                    text=\" \"\n",
    "                    \n",
    "                else:\n",
    "                    text = ocrclient.image_to_stringforcv2(roiimg)\n",
    "            except Exception as e:\n",
    "                #print(e)\n",
    "                print(\"RECT:[{}:{},{}:{}]\".format(\n",
    "                    ystart, xstart, yend, xend))\n",
    "                text = \"error\"\n",
    "            #print(row,colum)\n",
    "            tablelist[row][colum] = text\n",
    "        print(\" \".format(row))\n",
    "        #print(\"\")\n",
    "    return tablelist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from numba import jit\n",
    "@jit\n",
    "def removeStamp(dstimg,pointsTheshold=100,areathreshold = 10000.0,color = (255,255,255),debug=False):\n",
    "    dstimgT = dstimg.copy()\n",
    "    #if maskimg is None:\n",
    "    imgThresh= cv2.bilateralFilter(dstimgT, 21, 21 * 2, 25 / 2);\n",
    "    imgThresh = cv2.fastNlMeansDenoising(imgThresh, None, 21, 11, 21)\n",
    " \n",
    "    imgrayT=cv2.Canny(imgThresh,100,240,3)#Canny边缘检测，参数可更改\n",
    "    #ret,maskimgT = cv2.threshold(imgrayT,10,255,cv2.THRESH_BINARY)  \n",
    "    maskimgT = cv2.adaptiveThreshold(\n",
    "        imgrayT, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 35, 9)    \n",
    "    image, contours, hierarchy = cv2.findContours(maskimgT,cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)#contours为轮廓集，可以计算轮廓的长度、面积等  \n",
    "    #emptyImageTT = np.zeros(maskimgT.shape, np.uint8)\n",
    "    #print(len(contours))\n",
    "\n",
    "\n",
    "    #plt.show() \n",
    "    for cnt in contours:  \n",
    "        #print(len(cnt))\n",
    "        if len(cnt) > pointsTheshold:  \n",
    "            S1=cv2.contourArea(cnt)  \n",
    "            ell=cv2.fitEllipse(cnt)  \n",
    "            S2 =math.pi*ell[1][0]*ell[1][1] \n",
    "            #print(S2)\n",
    "            if S1 > areathreshold and (S1/S2)>0.005 and S1 < 100000:#面积比例，可以更改，根据数据集。。。  \n",
    "                #print(S1,S2,ell)\n",
    "                #cv2.drawContours(emptyImageTT, cnt, -1, (255, 255, 255), 2)\n",
    "                cv2.ellipse(dstimgT, ell,color, 15)\n",
    "                cv2.ellipse(dstimgT, ell,color, cv2.FILLED)\n",
    "\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(60.0,40.0)\n",
    "        plt.subplot(2,1,1),plt.imshow(imgrayT,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(dstimgT,'gray')            \n",
    "    return dstimgT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "path = 'I:/陈宁/对账单2/10'\n",
    "filename=\"10 中国银行 0833_1.jpg\"\n",
    "filepath=os.path.join(path,filename)\n",
    "iproc_obj = imgproc.ImageProc(filepath)\n",
    "img = removeStamp(iproc_obj.gray_img,debug=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "%reload_ext autoreload\n",
    "%autoreload 2\n",
    "\n",
    "canny_low_thresh=150\n",
    "canny_high_thresh=250\n",
    "canny_kernel_size=3\n",
    "hough_rho_res=1\n",
    "hough_theta_res=np.pi/650\n",
    "hough_votes_thresh=750\n",
    "hscale = 10\n",
    "vscale = 10\n",
    "\n",
    "\n",
    "def ocrimgtoexcel(filename,path,hscale = 10,vscale = 10,debug=False ):\n",
    "    print('1：读取文件{}'.format(filename))\n",
    "    filepath=os.path.join(path,filename)\n",
    "    iproc_obj = imgproc.ImageProc(filepath)\n",
    "    print('图像h={} w={}'.format(iproc_obj.input_img.shape[0],iproc_obj.input_img.shape[1]))\n",
    "\n",
    "    print('2：去除椭圆印章')\n",
    "    #img = iproc_obj.removeEllipseStamp(debug=debug)\n",
    "    # if debug:\n",
    "    # plt.gcf().set_size_inches(90,50)\n",
    "    # plt.subplot(1,1,1),plt.imshow(img,'gray')\n",
    "    # plt.show()\n",
    "    print('3：检测水平线和角度')\n",
    "    sum = 0.0\n",
    "    number = 0\n",
    "    lines_hough = iproc_obj.detect_lines(canny_low_thresh=canny_low_thresh,\n",
    "                                         canny_high_thresh=canny_high_thresh,\n",
    "                                         canny_kernel_size=canny_kernel_size,\n",
    "                                         hough_rho_res=1,\n",
    "                                         hough_theta_res=hough_theta_res,\n",
    "                                         hough_votes_thresh=hough_votes_thresh)\n",
    "\n",
    "\n",
    "    img_lines = iproc_obj.draw_lines(orig_img_as_background=True)\n",
    "    print('omit_on_rot_thresh: ',np.pi/10)\n",
    "    theta_rotate = iproc_obj.find_rotation_or_skew2(rot_thresh=0.001, rot_same_dir_thresh=0.1, omit_on_rot_thresh=np.pi/10,only_direction=DIRECTION_HORIZONTAL)\n",
    "    angle = degrees(theta_rotate[1])\n",
    "    print(\"-----方向{} 校正角度 {}\".format(theta_rotate[0],angle))\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(90,50)\n",
    "        plt.subplot(2,1,1),plt.imshow(iproc_obj.gray_img,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(img_lines,'gray')\n",
    "        plt.show()\n",
    "    print('3：水平校正')\n",
    "    rotate_image = iproc_obj.rotate_image(iproc_obj.gray_img,-angle)\n",
    "    print(rotate_image.shape)\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(40,30)\n",
    "        plt.subplot(1,1,1),plt.imshow(rotate_image,'gray')\n",
    "        plt.show()\n",
    "  \n",
    "    print('4：检测表格上下横线')\n",
    "    bordercut = 20\n",
    "    x1= 0+bordercut\n",
    "    y1= 0+bordercut    # 切掉周边，避免干扰\n",
    "    x2= rotate_image.shape[1]-bordercut\n",
    "    y2= rotate_image.shape[0]-bordercut\n",
    "    dt = detectTable(rotate_image[y1:y2, x1:x2])\n",
    "    #thresh_img = cv2.threshold(~rotate_image, 100, 255, cv2.THRESH_BINARY)[1]\n",
    "    imgThresh= cv2.bilateralFilter(rotate_image, 21, 21 * 2, 25 / 2);\n",
    "    imgThresh = cv2.fastNlMeansDenoising(imgThresh, None, 21, 11, 21)\n",
    "    thresh_img = cv2.adaptiveThreshold(\n",
    "        imgThresh, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 45, 9)\n",
    "    h_img = thresh_img.copy()\n",
    "    hscale = hscale\n",
    "    h_size = int(h_img.shape[1]/hscale)\n",
    "\n",
    "    h_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "    h_dashed_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (5, 1))  # 形态学因子\n",
    "    h_dilate_imgT = cv2.dilate(h_img, h_dashed_structure, 1) # 虚线转为实线\n",
    "    h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "    h_dilate_img = cv2.dilate(h_erode_img, h_structure, 1)\n",
    "\n",
    "\n",
    "    v_img = thresh_img.copy()\n",
    "    vscale = vscale\n",
    "    v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "    v_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "    v_dashed_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (1, 3))  # 形态学因子\n",
    "    v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "    v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "    v_dilate_img = cv2.dilate(v_erode_img, v_structure, 1)\n",
    "    mask = h_dilate_img + v_dilate_img\n",
    "    print(h_dilate_img.shape)\n",
    "    print(v_dilate_img.shape)\n",
    "    print(mask.shape)\n",
    "\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(60,50)\n",
    "        plt.subplot(2,1,1),plt.imshow(mask,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(thresh_img,'gray')\n",
    "        plt.show()\n",
    "        \n",
    "\n",
    "    print('5：计算表格上下线坐标')\n",
    "    border =1\n",
    "    dtable = detectTable(rotate_image)\n",
    "    h_threshold = int(rotate_image.shape[0]/8)\n",
    "    v_threshold = int(rotate_image.shape[1]/10)\n",
    "\n",
    "    x_count,x_segmentation = dtable.verticalShadowSplite(v_dilate_img,v_threshold)\n",
    "    y_count,y_segmentation = dtable.horizontalShadowSplite(h_dilate_img,h_threshold)\n",
    "    print(len(x_segmentation),len(y_segmentation))\n",
    "    \n",
    "    #print(len(y_segmentation))\n",
    "    if debug:\n",
    "        emptyImagev=dtable.getShadowimg(rotate_image,x_count,'V')\n",
    "        emptyImageh=dtable.getShadowimg(rotate_image,y_count,'H')\n",
    "        plt.gcf().set_size_inches(60.0,40.0)\n",
    "        plt.subplot(2,1,1),plt.imshow(emptyImagev,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(emptyImageh,'gray')\n",
    "        plt.show()\n",
    "\n",
    "    prerows=dt.getLineCor(rotate_image.shape[0],y_segmentation) \n",
    "    if len(prerows) == 0:\n",
    "        prerows.append(0)\n",
    "        prerows.append(rotate_image.shape[0])\n",
    "    if len(prerows) == 1:\n",
    "        rows[0] = 0\n",
    "        prerows.append(rotate_image.shape[0])\n",
    "\n",
    "    precolums=dt.getLineCor(rotate_image.shape[1],x_segmentation)   \n",
    "    print(precolums)\n",
    "    if len(precolums) == 0:\n",
    "        precolums.append(0)\n",
    "        precolums.append(rotate_image.shape[1])\n",
    "\n",
    "    if len(precolums) == 1:\n",
    "        precolums[0] = 0\n",
    "        precolums.append(rotate_image.shape[1])\n",
    "    #colums=dt.getLineCor(rotate_image.shape[1],x_segmentation)  \n",
    "    x1= precolums[0]+border\n",
    "    y1= prerows[0]+border   # 切掉周边，避免干扰 for \n",
    "    x2= precolums[-1]-border\n",
    "    y2= prerows[-1]-border\n",
    "    print(\"左上角x1={} y1={},右下角x2={} y2={}\".format(x1,y1,x2,y2))\n",
    "    #rotate_image = removeStamp(rotate_image)  #去掉印章\n",
    "    tablerect = rotate_image[y1:y2, x1:x2] #获取表格部分\n",
    "    maskT = mask[y1:y2, x1:x2]\n",
    "    if debug:\n",
    "        print(\"行参考{}列参考{}\".format(prerows,precolums))\n",
    "        print(x_segmentation,y_segmentation)\n",
    "\n",
    "        plt.gcf().set_size_inches(40.0,40.0)\n",
    "        plt.subplot(2,1,1),plt.imshow(tablerect,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(maskT,'gray')\n",
    "        plt.show()\n",
    "\n",
    "    print('6：分割前预处理')\n",
    "    # 消除噪音 ，便于分割\n",
    "    print(maskT.shape,tablerect.shape)\n",
    "    tableImgNoborder = cv2.add(maskT,tablerect) # 去掉边界\n",
    "\n",
    "    imgbilateral= cv2.bilateralFilter(tableImgNoborder, 15, 50, 30);   # 双边滤波，去除噪音，边缘不变\n",
    "    meansThresh = cv2.fastNlMeansDenoising(imgbilateral, None, 34, 21, 7) # 中值滤波，去除噪音\n",
    "    thresh_img = cv2.adaptiveThreshold(\n",
    "        meansThresh, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 25, 11) #二值化,通过阈值删除噪音\n",
    "    x_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (3, 3))\n",
    "    if len(prerows) > 3:\n",
    "        h_erode_img = maskT\n",
    "    else:\n",
    "        h_img = thresh_img.copy()\n",
    "        hscale = hscale\n",
    "        h_size = int(h_img.shape[1]/hscale)\n",
    "        print(h_size)\n",
    "        h_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "\n",
    "        h_erode_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (3, 3))  # 形态学因子\n",
    "        #h_dilate_imgT = cv2.dilate(h_img, h_structure, 1) # 横向膨胀\n",
    "        #h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "        h_MORPH_CLOSE_img=    cv2.morphologyEx(h_img,cv2.MORPH_CLOSE,h_structure)\n",
    "        h_erode_img = cv2.erode(h_MORPH_CLOSE_img, h_erode_structure, 1) \n",
    "\n",
    "    if len(precolums) > 3:\n",
    "        v_erode_img = maskT\n",
    "    else:\n",
    "        v_img = thresh_img.copy()\n",
    "        vscale = vscale\n",
    "        v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "        v_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "        v_erode_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (3, 3))  # 形态学因子\n",
    "        #v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "        #v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "        v_MORPH_CLOSE_img=    cv2.morphologyEx(v_img,cv2.MORPH_CLOSE,v_structure)\n",
    "        v_erode_img = cv2.morphologyEx(v_MORPH_CLOSE_img, cv2.MORPH_CLOSE,v_erode_structure)\n",
    "        #v_erode_img=    cv2.erode(v_MORPH_CLOSE_img,v_erode_structure)\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(40.0,40.0)\n",
    "        plt.subplot(3,1,1),plt.imshow(thresh_img,'gray')\n",
    "        plt.subplot(3,1,2),plt.imshow(h_erode_img,'gray')\n",
    "        plt.subplot(3,1,3),plt.imshow(v_erode_img,'gray')\n",
    "        plt.show()\n",
    "\n",
    "\n",
    "\n",
    "   \n",
    "    print('7：计算行和列分割线')\n",
    "    dt = detectTable(tableImgNoborder)\n",
    "    h_threshold = int(tableImgNoborder.shape[1]/5)\n",
    "    v_threshold = int(tableImgNoborder.shape[0]/5)\n",
    "\n",
    "    x_count,x_segmentation = dt.verticalShadowSplite(v_erode_img,v_threshold)  #垂直投影\n",
    "    y_count,y_segmentation = dt.horizontalShadowSplite(h_erode_img,h_threshold)  #水平投影\n",
    "\n",
    "    rows=dt.getLineCor(tableImgNoborder.shape[0],y_segmentation, False if len(prerows) > 3 else True)   #至少5行\n",
    "    colums=dt.getLineCor(tableImgNoborder.shape[1],x_segmentation, False if len(precolums) > 3 else True)     #至少4列\n",
    "    if len(prerows) <= 3 and len(rows) > 2:\n",
    "        rows[0]=0\n",
    "        rows[-1]=tableImgNoborder.shape[1]\n",
    "    if len(precolums) <= 3 and len(colums) > 2:\n",
    "        colums[0]=0\n",
    "        colums[-1]=tableImgNoborder.shape[1]\n",
    "    if tableImgNoborder.shape[0] - rows[-1] >20:\n",
    "        rows.append(tableImgNoborder.shape[0]-1)\n",
    "    if tableImgNoborder.shape[1] - colums[-1] >20:    \n",
    "        colums.append(tableImgNoborder.shape[1]-1)\n",
    "    print(len(rows),len(colums))\n",
    "    print('rows=',rows)\n",
    "    print('colums=',colums)\n",
    "    if debug:\n",
    "        emptyImagev=dt.getShadowimg(tableImgNoborder,x_count,'V')\n",
    "        emptyImageh=dt.getShadowimg(tableImgNoborder,y_count,'H')\n",
    "        white = (255, 255, 255)\n",
    "        black = (0, 0, 0)\n",
    "        h,w=thresh_img.shape\n",
    "        emptyImage = tableImgNoborder.copy()\n",
    "        for x in colums:\n",
    "            cv2.line(emptyImage, (x, 0), (x, h), black)\n",
    "        for y in rows:\n",
    "\n",
    "            cv2.line(emptyImage, (0, y), (w, y), black)\n",
    "        cv2.imwrite('test.jpg',emptyImage)\n",
    "        plt.gcf().set_size_inches(80.0,60.0)\n",
    "        plt.subplot(3,1,1),plt.imshow(emptyImagev,'gray')\n",
    "        plt.subplot(3,1,2),plt.imshow(emptyImageh,'gray')\n",
    "        plt.subplot(3,1,3),plt.imshow(emptyImage,'gray')\n",
    "        plt.show()\n",
    "    \n",
    "    print('8：每个cell进行识别的tablelist') \n",
    "    savename,extension = os.path.splitext(filename)\n",
    "    tempoutpath=os.path.join(path,tempout)\n",
    "    if not os.path.exists(tempoutpath):\n",
    "        os.makedirs(tempoutpath)\n",
    "    savepath = os.path.join(tempoutpath,savename+'.xlsx')      \n",
    "    \n",
    "\n",
    "    tablelist = imgtotable(tableImgNoborder,rows,colums,debug)\n",
    "    print('9：保存文件')       \n",
    "\n",
    "\n",
    "    df=pd.DataFrame(tablelist)\n",
    "\n",
    "    if not os.path.exists(tempoutpath):\n",
    "        os.makedirs(tempoutpath)\n",
    "    savepath = os.path.join(tempoutpath,savename+'.xlsx')\n",
    "    writer = pd.ExcelWriter(savepath)\n",
    "    df.to_excel(writer, sheet_name=savename)\n",
    "    writer.save()\n",
    "    writer.close()\n",
    "    print('10：{}.jpg '.format(savename))\n",
    "    \n",
    "    return tablelist\n",
    " "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "path = 'I:/陈宁/对账单2/10'\n",
    "filename=\"10 中国银行 0833_1.jpg\"\n",
    "ocrimgtoexcel(filename,path,debug=True)\n",
    "print('ok')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "处理 I:/陈宁/对账单2/15 目录下图片\n",
      "---- 1.jpg is start---\n",
      "1：读取文件1.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.009666486582483813 None True False\n",
      "-----方向sx 校正角度 0.5538488838961613\n",
      "3：水平校正\n",
      "points.length()=38118\n",
      "校正角度-0.5538488838961613--0.5538488838961613\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[71, 278, 439, 624, 923, 1223, 1443, 1640, 1942, 2383, 2733, 3036, 3385]\n",
      "左上角x1=72 y1=478,右下角x2=3384 y2=1632\n",
      "6：分割前预处理\n",
      "(1154, 3312) (1154, 3312)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [2, 58, 113, 202, 258, 315, 372, 429, 517, 573, 661, 750, 807, 895, 952, 1010, 1068, 1153]\n",
      "colums= [205, 367, 551, 851, 1151, 1371, 1568, 1870, 2311, 2660, 2963, 3311]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：1.jpg \n",
      "----1.jpg is complete--- \n",
      "---- 10.jpg is start---\n",
      "1：读取文件10.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=129568\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 435, 620, 920, 1220, 1440, 1637, 1939, 2381, 2730, 3033, 3383]\n",
      "左上角x1=68 y1=473,右下角x2=3382 y2=1724\n",
      "6：分割前预处理\n",
      "(1251, 3314) (1251, 3314)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [3, 60, 116, 204, 260, 317, 373, 461, 550, 607, 664, 752, 841, 898, 987, 1076, 1165, 1250]\n",
      "colums= [206, 367, 551, 852, 1152, 1372, 1569, 1870, 2313, 2662, 2965, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：10.jpg \n",
      "----10.jpg is complete--- \n",
      "---- 11.jpg is start---\n",
      "1：读取文件11.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=35802\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 435, 619, 920, 1220, 1441, 1637, 1939, 2382, 2730, 3033, 3383]\n",
      "左上角x1=68 y1=476,右下角x2=3382 y2=1663\n",
      "6：分割前预处理\n",
      "(1187, 3314) (1187, 3314)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 58, 146, 202, 291, 348, 404, 461, 518, 607, 664, 752, 840, 897, 954, 1043, 1100, 1186]\n",
      "colums= [206, 367, 552, 852, 1152, 1372, 1570, 1871, 2314, 2662, 2965, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：11.jpg \n",
      "----11.jpg is complete--- \n",
      "---- 12.jpg is start---\n",
      "1：读取文件12.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=31950\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 436, 620, 920, 1220, 1441, 1637, 1938, 2381, 2731, 3034, 3384]\n",
      "左上角x1=68 y1=473,右下角x2=3383 y2=1724\n",
      "6：分割前预处理\n",
      "(1251, 3315) (1251, 3315)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 60, 147, 235, 323, 411, 468, 557, 614, 671, 728, 817, 873, 962, 1052, 1108, 1165, 1250]\n",
      "colums= [206, 368, 552, 852, 1152, 1373, 1570, 1870, 2313, 2663, 2966, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：12.jpg \n",
      "----12.jpg is complete--- \n",
      "---- 13.jpg is start---\n",
      "1：读取文件13.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=36188\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[68, 275, 436, 621, 920, 1220, 1440, 1637, 1939, 2381, 2730, 3033, 3383]\n",
      "左上角x1=69 y1=475,右下角x2=3382 y2=1597\n",
      "6：分割前预处理\n",
      "(1122, 3313) (1122, 3313)\n",
      "7：计算行和列分割线\n",
      "17 12\n",
      "rows= [59, 114, 202, 259, 316, 404, 461, 550, 606, 663, 720, 777, 833, 922, 979, 1037, 1121]\n",
      "colums= [206, 367, 552, 851, 1151, 1371, 1569, 1870, 2312, 2661, 2964, 3312]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：13.jpg \n",
      "----13.jpg is complete--- \n",
      "---- 14.jpg is start---\n",
      "1：读取文件14.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=82800\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[66, 274, 435, 620, 920, 1219, 1439, 1637, 1938, 2380, 2730, 3032, 3383]\n",
      "左上角x1=67 y1=475,右下角x2=3382 y2=1565\n",
      "6：分割前预处理\n",
      "(1090, 3315) (1090, 3315)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 60, 114, 171, 228, 285, 341, 398, 454, 543, 600, 657, 713, 802, 859, 947, 1005, 1089]\n",
      "colums= [207, 368, 553, 853, 1152, 1372, 1570, 1871, 2313, 2663, 2965, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：14.jpg \n",
      "----14.jpg is complete--- \n",
      "---- 15.jpg is start---\n",
      "1：读取文件15.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=28550\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 435, 620, 920, 1220, 1440, 1637, 1939, 2380, 2730, 3033, 3383]\n",
      "左上角x1=68 y1=474,右下角x2=3382 y2=1628\n",
      "6：分割前预处理\n",
      "(1154, 3314) (1154, 3314)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 60, 114, 170, 227, 283, 341, 398, 455, 544, 600, 689, 745, 834, 922, 979, 1069, 1153]\n",
      "colums= [206, 367, 552, 852, 1152, 1372, 1569, 1871, 2312, 2662, 2966, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：15.jpg \n",
      "----15.jpg is complete--- \n",
      "---- 16.jpg is start---\n",
      "1：读取文件16.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=36142\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 435, 620, 920, 1220, 1440, 1638, 1939, 2381, 2730, 3034, 3383]\n",
      "左上角x1=68 y1=473,右下角x2=3382 y2=1725\n",
      "6：分割前预处理\n",
      "(1252, 3314) (1252, 3314)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 60, 115, 172, 229, 317, 374, 462, 551, 608, 664, 753, 841, 930, 987, 1076, 1165, 1251]\n",
      "colums= [206, 368, 552, 853, 1152, 1372, 1569, 1871, 2313, 2662, 2966, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：16.jpg \n",
      "----16.jpg is complete--- \n",
      "---- 17.jpg is start---\n",
      "1：读取文件17.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[63, 270, 431, 616, 917, 1216, 1436, 1633, 1935, 2377, 2727, 3030, 3380]\n",
      "左上角x1=64 y1=478,右下角x2=3379 y2=1729\n",
      "6：分割前预处理\n",
      "(1251, 3315) (1251, 3315)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 60, 146, 203, 259, 316, 404, 494, 551, 608, 696, 785, 841, 930, 987, 1075, 1165, 1250]\n",
      "colums= [206, 367, 552, 853, 1152, 1373, 1569, 1871, 2313, 2663, 2966, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：17.jpg \n",
      "----17.jpg is complete--- \n",
      "---- 18.jpg is start---\n",
      "1：读取文件18.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=35038\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[69, 275, 437, 622, 922, 1221, 1441, 1639, 1940, 2382, 2731, 3034, 3384]\n",
      "左上角x1=70 y1=478,右下角x2=3383 y2=1601\n",
      "6：分割前预处理\n",
      "(1123, 3313) (1123, 3313)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 60, 115, 171, 260, 350, 406, 462, 518, 575, 632, 689, 746, 803, 892, 981, 1038, 1122]\n",
      "colums= [205, 367, 552, 852, 1152, 1371, 1569, 1870, 2312, 2660, 2964, 3312]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：18.jpg \n",
      "----18.jpg is complete--- \n",
      "---- 19.jpg is start---\n",
      "1：读取文件19.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=31444\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[69, 276, 437, 622, 922, 1222, 1442, 1639, 1941, 2383, 2732, 3035, 3386]\n",
      "左上角x1=70 y1=474,右下角x2=3385 y2=1661\n",
      "6：分割前预处理\n",
      "(1187, 3315) (1187, 3315)\n",
      "7：计算行和列分割线\n",
      "17 12\n",
      "rows= [59, 114, 202, 259, 347, 404, 493, 550, 638, 727, 784, 841, 930, 986, 1043, 1101, 1186]\n",
      "colums= [206, 367, 552, 852, 1152, 1372, 1569, 1871, 2313, 2662, 2965, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：19.jpg \n",
      "----19.jpg is complete--- \n",
      "---- 2.jpg is start---\n",
      "1：读取文件2.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=27070\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 436, 620, 921, 1220, 1441, 1638, 1939, 2381, 2731, 3033, 3384]\n",
      "左上角x1=68 y1=475,右下角x2=3383 y2=1628\n",
      "6：分割前预处理\n",
      "(1153, 3315) (1153, 3315)\n",
      "7：计算行和列分割线\n",
      "17 12\n",
      "rows= [59, 114, 170, 226, 283, 339, 396, 453, 541, 630, 687, 776, 833, 922, 978, 1067, 1152]\n",
      "colums= [207, 368, 552, 853, 1153, 1373, 1570, 1871, 2313, 2663, 2965, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：2.jpg \n",
      "----2.jpg is complete--- \n",
      "---- 20.jpg is start---\n",
      "1：读取文件20.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=25600\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[69, 276, 437, 622, 922, 1222, 1442, 1639, 1941, 2383, 2732, 3035, 3386]\n",
      "左上角x1=70 y1=473,右下角x2=3385 y2=1725\n",
      "6：分割前预处理\n",
      "(1252, 3315) (1252, 3315)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 60, 147, 203, 292, 349, 437, 494, 551, 640, 729, 818, 906, 963, 1052, 1109, 1166, 1251]\n",
      "colums= [206, 367, 552, 852, 1152, 1372, 1569, 1871, 2314, 2662, 2966, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：20.jpg \n",
      "----20.jpg is complete--- \n",
      "---- 21.jpg is start---\n",
      "1：读取文件21.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=34744\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[69, 275, 437, 621, 922, 1222, 1441, 1638, 1940, 2383, 2731, 3034, 3385]\n",
      "左上角x1=70 y1=477,右下角x2=3384 y2=1727\n",
      "6：分割前预处理\n",
      "(1250, 3314) (1250, 3314)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 59, 145, 201, 257, 346, 435, 524, 581, 638, 726, 783, 871, 929, 985, 1074, 1163, 1249]\n",
      "colums= [205, 366, 551, 852, 1152, 1371, 1568, 1870, 2312, 2661, 2964, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：21.jpg \n",
      "----21.jpg is complete--- \n",
      "---- 22.jpg is start---\n",
      "1：读取文件22.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=30458\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[69, 276, 437, 622, 922, 1221, 1442, 1639, 1940, 2383, 2732, 3035, 3386]\n",
      "左上角x1=70 y1=477,右下角x2=3385 y2=1664\n",
      "6：分割前预处理\n",
      "(1187, 3315) (1187, 3315)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 59, 146, 235, 323, 380, 437, 494, 550, 607, 664, 721, 778, 835, 924, 1013, 1102, 1186]\n",
      "colums= [206, 367, 552, 852, 1152, 1372, 1569, 1871, 2313, 2663, 2965, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：22.jpg \n",
      "----22.jpg is complete--- \n",
      "---- 23.jpg is start---\n",
      "1：读取文件23.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=31224\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[66, 273, 435, 619, 919, 1219, 1439, 1637, 1938, 2380, 2729, 3032, 3382]\n",
      "左上角x1=67 y1=475,右下角x2=3381 y2=1662\n",
      "6：分割前预处理\n",
      "(1187, 3314) (1187, 3314)\n",
      "7：计算行和列分割线\n",
      "17 12\n",
      "rows= [60, 115, 171, 259, 316, 404, 461, 518, 606, 695, 752, 841, 897, 986, 1043, 1101, 1186]\n",
      "colums= [206, 368, 553, 853, 1152, 1372, 1570, 1871, 2313, 2662, 2965, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：23.jpg \n",
      "----23.jpg is complete--- \n",
      "---- 24.jpg is start---\n",
      "1：读取文件24.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=45906\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[68, 275, 436, 621, 921, 1220, 1441, 1638, 1940, 2381, 2731, 3034, 3383]\n",
      "左上角x1=69 y1=473,右下角x2=3382 y2=1628\n",
      "6：分割前预处理\n",
      "(1155, 3313) (1155, 3313)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 59, 146, 202, 259, 316, 405, 462, 518, 607, 663, 720, 777, 833, 923, 979, 1069, 1154]\n",
      "colums= [206, 368, 552, 852, 1152, 1372, 1569, 1871, 2312, 2662, 2965, 3312]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：24.jpg \n",
      "----24.jpg is complete--- \n",
      "---- 25.jpg is start---\n",
      "1：读取文件25.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.009666486582483813 None True False\n",
      "-----方向sx 校正角度 0.5538488838961613\n",
      "3：水平校正\n",
      "points.length()=38434\n",
      "校正角度-0.5538488838961613--0.5538488838961613\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 435, 620, 920, 1220, 1439, 1637, 1939, 2380, 2730, 3033, 3383]\n",
      "左上角x1=68 y1=475,右下角x2=3382 y2=1694\n",
      "6：分割前预处理\n",
      "(1219, 3314) (1219, 3314)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [3, 59, 114, 171, 228, 315, 404, 461, 550, 606, 663, 720, 809, 865, 954, 1042, 1132, 1218]\n",
      "colums= [205, 367, 552, 852, 1152, 1371, 1569, 1871, 2312, 2661, 2965, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：25.jpg \n",
      "----25.jpg is complete--- \n",
      "---- 26.jpg is start---\n",
      "1：读取文件26.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 13\n",
      "[67, 273, 435, 620, 920, 1219, 1440, 1636, 1938, 2380, 2729, 3032, 3382]\n",
      "左上角x1=68 y1=475,右下角x2=3381 y2=1280\n",
      "6：分割前预处理\n",
      "(805, 3313) (805, 3313)\n",
      "7：计算行和列分割线\n",
      "13 12\n",
      "rows= [1, 59, 145, 202, 259, 348, 404, 462, 517, 574, 663, 720, 804]\n",
      "colums= [205, 367, 552, 852, 1151, 1372, 1568, 1870, 2312, 2661, 2964, 3312]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：26.jpg \n",
      "----26.jpg is complete--- \n",
      "---- 3.jpg is start---\n",
      "1：读取文件3.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.009666486582483813 None True False\n",
      "-----方向sx 校正角度 0.5538488838961613\n",
      "3：水平校正\n",
      "points.length()=32612\n",
      "校正角度-0.5538488838961613--0.5538488838961613\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 274, 435, 620, 920, 1220, 1439, 1637, 1938, 2380, 2729, 3032, 3382]\n",
      "左上角x1=68 y1=474,右下角x2=3381 y2=1725\n",
      "6：分割前预处理\n",
      "(1251, 3313) (1251, 3313)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [3, 60, 146, 234, 291, 380, 436, 494, 550, 607, 695, 752, 841, 898, 986, 1075, 1166, 1250]\n",
      "colums= [205, 367, 551, 851, 1152, 1371, 1568, 1870, 2312, 2661, 2964, 3312]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：3.jpg \n",
      "----3.jpg is complete--- \n",
      "---- 4.jpg is start---\n",
      "1：读取文件4.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.009666486582483813 None True False\n",
      "-----方向sx 校正角度 0.5538488838961613\n",
      "3：水平校正\n",
      "points.length()=81054\n",
      "校正角度-0.5538488838961613--0.5538488838961613\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[71, 277, 439, 623, 924, 1223, 1443, 1641, 1942, 2384, 2733, 3037, 3386]\n",
      "左上角x1=72 y1=475,右下角x2=3385 y2=1661\n",
      "6：分割前预处理\n",
      "(1186, 3313) (1186, 3313)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [2, 60, 115, 171, 259, 315, 372, 429, 485, 542, 630, 720, 809, 865, 922, 1011, 1100, 1185]\n",
      "colums= [205, 367, 552, 852, 1151, 1371, 1568, 1870, 2312, 2661, 2964, 3312]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：4.jpg \n",
      "----4.jpg is complete--- \n",
      "---- 5.jpg is start---\n",
      "1：读取文件5.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.009666486582483813 None True False\n",
      "-----方向sx 校正角度 0.5538488838961613\n",
      "3：水平校正\n",
      "points.length()=41154\n",
      "校正角度-0.5538488838961613--0.5538488838961613\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[68, 275, 436, 621, 921, 1221, 1441, 1639, 1940, 2382, 2731, 3034, 3384]\n",
      "左上角x1=69 y1=479,右下角x2=3383 y2=1665\n",
      "6：分割前预处理\n",
      "(1186, 3314) (1186, 3314)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 58, 145, 233, 322, 379, 435, 492, 549, 605, 693, 750, 807, 864, 953, 1010, 1099, 1185]\n",
      "colums= [206, 367, 552, 852, 1152, 1372, 1570, 1871, 2312, 2662, 2965, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：5.jpg \n",
      "----5.jpg is complete--- \n",
      "---- 6.jpg is start---\n",
      "1：读取文件6.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=29746\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 273, 435, 620, 920, 1220, 1440, 1637, 1940, 2381, 2730, 3033, 3384]\n",
      "左上角x1=68 y1=475,右下角x2=3383 y2=1629\n",
      "6：分割前预处理\n",
      "(1154, 3315) (1154, 3315)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [1, 59, 146, 202, 259, 316, 372, 429, 486, 543, 600, 656, 745, 802, 923, 979, 1068, 1153]\n",
      "colums= [206, 367, 552, 852, 1152, 1372, 1569, 1872, 2313, 2662, 2966, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：6.jpg \n",
      "----6.jpg is complete--- \n",
      "---- 7.jpg is start---\n",
      "1：读取文件7.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.009666486582483813 None True False\n",
      "-----方向sx 校正角度 0.5538488838961613\n",
      "3：水平校正\n",
      "points.length()=25922\n",
      "校正角度-0.5538488838961613--0.5538488838961613\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[69, 276, 438, 622, 923, 1222, 1442, 1640, 1941, 2383, 2733, 3036, 3386]\n",
      "左上角x1=70 y1=474,右下角x2=3385 y2=1757\n",
      "6：分割前预处理\n",
      "(1283, 3315) (1283, 3315)\n",
      "7：计算行和列分割线\n",
      "18 12\n",
      "rows= [3, 59, 146, 203, 292, 380, 469, 557, 614, 702, 758, 815, 904, 961, 1017, 1106, 1197, 1282]\n",
      "colums= [206, 367, 552, 853, 1152, 1372, 1569, 1871, 2313, 2663, 2966, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：7.jpg \n",
      "----7.jpg is complete--- \n",
      "---- 8.jpg is start---\n",
      "1：读取文件8.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[67, 273, 435, 620, 920, 1219, 1439, 1636, 1939, 2380, 2729, 3032, 3383]\n",
      "左上角x1=68 y1=479,右下角x2=3382 y2=1760\n",
      "6：分割前预处理\n",
      "(1281, 3314) (1281, 3314)\n",
      "7：计算行和列分割线\n",
      "22 12\n",
      "rows= [1, 59, 114, 202, 258, 315, 402, 492, 580, 636, 725, 814, 871, 957, 962, 1045, 1047, 1051, 1134, 1139, 1196, 1280]\n",
      "colums= [205, 367, 552, 852, 1151, 1371, 1568, 1871, 2312, 2661, 2964, 3313]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： RECT:[957:205,962:367]\n",
      "列1： RECT:[957:367,962:552]\n",
      "列2： RECT:[957:552,962:852]\n",
      "列3： RECT:[957:852,962:1151]\n",
      "列4： RECT:[957:1151,962:1371]\n",
      "列5： RECT:[957:1371,962:1568]\n",
      "列6： RECT:[957:1568,962:1871]\n",
      "列7： RECT:[957:1871,962:2312]\n",
      "列8： RECT:[957:2312,962:2661]\n",
      "列9： RECT:[957:2661,962:2964]\n",
      "列10： RECT:[957:2964,962:3313]\n",
      " \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： RECT:[1045:205,1047:367]\n",
      "列1： RECT:[1045:367,1047:552]\n",
      "列2： RECT:[1045:552,1047:852]\n",
      "列3： RECT:[1045:852,1047:1151]\n",
      "列4： RECT:[1045:1151,1047:1371]\n",
      "列5： RECT:[1045:1371,1047:1568]\n",
      "列6： RECT:[1045:1568,1047:1871]\n",
      "列7： RECT:[1045:1871,1047:2312]\n",
      "列8： RECT:[1045:2312,1047:2661]\n",
      "列9： RECT:[1045:2661,1047:2964]\n",
      "列10： RECT:[1045:2964,1047:3313]\n",
      " \n",
      "行16： 列0： RECT:[1047:205,1051:367]\n",
      "列1： 列2： 列3： RECT:[1047:852,1051:1151]\n",
      "列4： RECT:[1047:1151,1051:1371]\n",
      "列5： RECT:[1047:1371,1051:1568]\n",
      "列6： RECT:[1047:1568,1051:1871]\n",
      "列7： RECT:[1047:1871,1051:2312]\n",
      "列8： RECT:[1047:2312,1051:2661]\n",
      "列9： 列10：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行18： 列0： RECT:[1134:205,1139:367]\n",
      "列1： RECT:[1134:367,1139:552]\n",
      "列2： RECT:[1134:552,1139:852]\n",
      "列3： RECT:[1134:852,1139:1151]\n",
      "列4： RECT:[1134:1151,1139:1371]\n",
      "列5： RECT:[1134:1371,1139:1568]\n",
      "列6： RECT:[1134:1568,1139:1871]\n",
      "列7： 列8： 列9： RECT:[1134:2661,1139:2964]\n",
      "列10： RECT:[1134:2964,1139:3313]\n",
      " \n",
      "行19： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行20： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：8.jpg \n",
      "----8.jpg is complete--- \n",
      "---- 9.jpg is start---\n",
      "1：读取文件9.jpg\n",
      "图像h=2479 w=3504\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.004833265146936938 None True False\n",
      "-----方向sx 校正角度 0.27692569418716423\n",
      "3：水平校正\n",
      "points.length()=28018\n",
      "校正角度-0.27692569418716423--0.27692569418716423\n",
      "(2479, 3504)\n",
      "4：检测表格上下横线\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "(2479, 3504)\n",
      "5：计算表格上下线坐标\n",
      "13 18\n",
      "[68, 275, 436, 621, 921, 1221, 1441, 1638, 1940, 2382, 2731, 3035, 3385]\n",
      "左上角x1=69 y1=472,右下角x2=3384 y2=1755\n",
      "6：分割前预处理\n",
      "(1283, 3315) (1283, 3315)\n",
      "7：计算行和列分割线\n",
      "17 12\n",
      "rows= [59, 145, 234, 322, 411, 468, 556, 612, 669, 758, 815, 904, 961, 1050, 1107, 1196, 1282]\n",
      "colums= [206, 367, 552, 852, 1153, 1372, 1569, 1871, 2313, 2662, 2966, 3314]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：9.jpg \n",
      "----9.jpg is complete--- \n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "\n",
    "fpathe = 'I:/陈宁/对账单2/15'\n",
    "print(\"处理 {} 目录下图片\".format(fpathe))\n",
    "writer = pd.ExcelWriter(os.path.join(fpathe,'allpages.xlsx'))\n",
    "all_tablelist = []\n",
    "for fpath,dirs,fs in os.walk(fpathe):\n",
    "    \n",
    "    for file in fs:\n",
    "        fname,extension = os.path.splitext(file)\n",
    "        \n",
    "        if extension != '.jpg':\n",
    "            continue\n",
    "        print(\"---- {} is start---\".format(file))\n",
    "        tablelist = ocrimgtoexcel(file,fpath,debug=False)\n",
    "        all_tablelist.append(['No {} page'.format(fname)])\n",
    "        all_tablelist.extend(tablelist)\n",
    "        \n",
    "        print(\"----{} is complete--- \".format(file))\n",
    "sheet_data=pd.DataFrame(all_tablelist)\n",
    "sheet_data.to_excel(writer, sheet_name=fname)\n",
    "writer.save()\n",
    "writer.close()  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "debug = True\n",
    "path = 'j:/icbc/'\n",
    "filename=\"2.jpg\"\n",
    "\n",
    "print('1：读取文件')\n",
    "filepath=os.path.join(path,filename)\n",
    "img = cv2.imread(filepath,0)\n",
    "# create a CLAHE object (Arguments are optional).\n",
    "clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8,8))\n",
    "cl1 = clahe.apply(img)\n",
    "sigma = 1; threshold = 3; amount = 1\n",
    "blurred=cv2.GaussianBlur(cl1,(0,0),1,None,1)\n",
    "#blurred1 = cv2.adaptiveThreshold(\n",
    "#    blurred, 255, cv2.ADAPTIVE_THRESH_MEAN_C, cv2.THRESH_BINARY, 15, -2)\n",
    "lowContrastMask = abs(cl1 - blurred) < threshold\n",
    "sharpened = blurred*(1+amount) + blurred*(-amount)\n",
    "image=cv2.bitwise_or(sharpened.astype(np.uint8),lowContrastMask.astype(np.uint8))\n",
    "plt.gcf().set_size_inches(50.0,60.0)\n",
    "plt.subplot(2,1,1),plt.imshow(blurred,'gray')\n",
    "plt.subplot(2,1,2),plt.imshow(image,'gray')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "hist,bins = np.histogram(img.flatten(),256,[0,256])\n",
    "cdf = hist.cumsum()\n",
    "cdf_normalized = cdf * float(hist.max()) / cdf.max()\n",
    "plt.plot(cdf_normalized, color = 'b')\n",
    "plt.hist(img.flatten(),256,[0,256], color = 'r')\n",
    "plt.xlim([0,256])\n",
    "plt.legend(('cdf','histogram'), loc = 'upper left')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "debug = True\n",
    "\n",
    "path = 'I:/陈宁/对账单/2'\n",
    "filename=\"2_页面_01.jpg\"\n",
    "\n",
    "print('1：读取文件')\n",
    "filepath=os.path.join(path,filename)\n",
    "iproc_obj = imgproc.ImageProc(filepath)\n",
    "thresh_img = cv2.adaptiveThreshold(\n",
    "    iproc_obj.gray_img, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 25, 11) #二值化,通过阈值删除噪音\n",
    "hscale = 10\n",
    "\n",
    "h_img = thresh_img.copy()\n",
    "h_size = int(h_img.shape[1]/hscale)\n",
    "x_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (3, 3))\n",
    "\n",
    "\n",
    "\n",
    "h_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "\n",
    "h_erode_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, 5))  # 形态学因子\n",
    "#h_dilate_imgT = cv2.dilate(h_img, h_structure, 1) # 横向膨胀\n",
    "#h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "h_MORPH_CLOSE_img=    cv2.morphologyEx(h_img,cv2.MORPH_CLOSE,h_structure)\n",
    "h_erode_img = cv2.erode(h_MORPH_CLOSE_img, h_erode_structure, 1) \n",
    "\n",
    "\n",
    "v_img = thresh_img.copy()\n",
    "vscale = 10\n",
    "v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "v_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "v_erode_structure = cv2.getStructuringElement(    imgThresh = cv2.fastNlMeansDenoising(rotate_image, None, 21, 11, 21)\n",
    "    #imgThresh = cv2.fastNlMeansDenoisingColored(rotate_image, None, 10, 10, 7, 21)\n",
    " # 形态学因子\n",
    "#v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "#v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "v_MORPH_CLOSE_img=    cv2.morphologyEx(v_img,cv2.MORPH_CLOSE,v_structure)\n",
    "#v_erode_img = cv2.erode(v_MORPH_CLOSE_img, v_erode_structure, 1)\n",
    "v_erode_img=    cv2.morphologyEx(v_MORPH_CLOSE_img,cv2.MORPH_CLOSE,v_erode_structure)\n",
    "if debug:\n",
    "    plt.gcf().set_size_inches(40.0,50.0)\n",
    "    plt.subplot(3,1,1),plt.imshow(thresh_img,'gray')\n",
    "    plt.subplot(3,1,2),plt.imshow(h_erode_img,'gray')\n",
    "    plt.subplot(3,1,3),plt.imshow(v_erode_img,'gray')\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "debug = True\n",
    "\n",
    "path = 'I:/陈宁/对账单/2'\n",
    "filename=\"2_页面_01.jpg\"\n",
    "\n",
    "print('1：读取文件')\n",
    "filepath=os.path.join(path,filename)\n",
    "iproc_obj = imgproc.ImageProc(filepath)\n",
    "thresh_img = cv2.adaptiveThreshold(\n",
    "    iproc_obj.gray_img, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 45, 9)\n",
    "h_img = thresh_img.copy()\n",
    "hscale = hscale\n",
    "h_size = int(h_img.shape[1]/hscale)\n",
    "\n",
    "h_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "h_dashed_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (5, 1))  # 形态学因子\n",
    "h_dilate_imgT = cv2.dilate(h_img, h_dashed_structure, 1) # 虚线转为实线\n",
    "h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "h_dilate_img = cv2.dilate(h_erode_img, h_structure, 1)\n",
    "\n",
    "\n",
    "v_img = thresh_img.copy()\n",
    "vscale = vscale\n",
    "v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "v_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "v_dashed_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, 1))  # 形态学因子\n",
    "v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "v_dilate_img = cv2.dilate(v_erode_img, v_structure, 1)\n",
    "\n",
    "if debug:\n",
    "    plt.gcf().set_size_inches(40.0,50.0)\n",
    "    plt.subplot(3,1,1),plt.imshow(thresh_img,'gray')\n",
    "    plt.subplot(3,1,2),plt.imshow(h_dilate_img,'gray')\n",
    "    plt.subplot(3,1,3),plt.imshow(v_dilate_img,'gray')\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "img = cv2.imread(filepath,0)\n",
    "equ = cv2.equalizeHist(img)\n",
    "res = np.hstack((img,equ)) #stacking images side-by-side\n",
    "plt.gcf().set_size_inches(60.0,40.0)\n",
    "plt.subplot(2,1,1),plt.imshow(img,'gray')\n",
    "plt.subplot(2,1,2),plt.imshow(equ,'gray')\n",
    "plt.show()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}

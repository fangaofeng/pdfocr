{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "%config InlineBackend.figure_format = 'svg'\n",
    "import os\n",
    "try:\n",
    "    import Image\n",
    "except ImportError:\n",
    "    from PIL import Image\n",
    "import cv2\n",
    "import numpy as np\n",
    "import pytesseract\n",
    "from matplotlib import pyplot as plt\n",
    "import math\n",
    "from math import radians, degrees\n",
    "from skewManager import imgproc\n",
    "from skewManager.common import ROTATION, SKEW_X, SKEW_Y, DIRECTION_HORIZONTAL, DIRECTION_VERTICAL\n",
    "from tabledetect import detectTable\n",
    "import pandas as pd\n",
    "import json\n",
    "from BaiduAipOcr import BaiduAipOcr\n",
    "\n",
    "\n",
    "\n",
    "tempout = \"temp/\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def LineToArea(lines):\n",
    "    area = []\n",
    "    if len(lines) <= 1:\n",
    "        return area\n",
    "    for i in range(len(lines)-1):\n",
    "        area.append((lines[i], lines[i+1]))\n",
    "    return area\n",
    "\n",
    "\n",
    "def imgtotable(img,rows,colums,debug=False):\n",
    "    ocrclient = BaiduAipOcr()\n",
    "    tablelist = [[\"\" for col in range(0,len(colums))] for row in range(0,len(rows))]\n",
    "    cloumarea = LineToArea(colums)\n",
    "    rowsarea = LineToArea(rows)\n",
    "    #print(tablelist)\n",
    "    for row, (ystart,yend) in enumerate(rowsarea):\n",
    "        \n",
    "        print(\"行{}：\".format(row),end=\" \")\n",
    "        for colum,(xstart,xend) in enumerate(cloumarea):\n",
    "            roiimg = img[ystart:yend,\n",
    "                  xstart:xend]\n",
    "\n",
    "\n",
    "            if debug:\n",
    "                \n",
    "                cv2.imwrite(\"testimage/{}{}.jpg\".format(row,colum),roiimg)\n",
    "\n",
    "            try:\n",
    "                print(\"列{}：\".format(colum),end=\" \")\n",
    "                if debug:\n",
    "                    text=\" \"\n",
    "                    \n",
    "                else:\n",
    "                    text = ocrclient.image_to_stringforcv2(roiimg)\n",
    "            except Exception as e:\n",
    "                #print(e)\n",
    "                print(\"RECT:[{}:{},{}:{}]\".format(\n",
    "                    ystart, xstart, yend, xend))\n",
    "                text = \"error\"\n",
    "            #print(row,colum)\n",
    "            tablelist[row][colum] = text\n",
    "        print(\" \".format(row))\n",
    "        #print(\"\")\n",
    "    return tablelist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from numba import jit\n",
    "@jit\n",
    "def removeStamp(dstimg,pointsTheshold=100,areathreshold = 10000.0,color = (255,255,255),debug=False):\n",
    "    dstimgT = dstimg.copy()\n",
    "    #if maskimg is None:\n",
    "    imgThresh= cv2.bilateralFilter(dstimgT, 21, 21 * 2, 25 / 2);\n",
    "    imgThresh = cv2.fastNlMeansDenoising(imgThresh, None, 21, 11, 21)\n",
    " \n",
    "    imgrayT=cv2.Canny(imgThresh,100,240,3)#Canny边缘检测，参数可更改\n",
    "    #ret,maskimgT = cv2.threshold(imgrayT,10,255,cv2.THRESH_BINARY)  \n",
    "    maskimgT = cv2.adaptiveThreshold(\n",
    "        imgrayT, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 35, 9)    \n",
    "    image, contours, hierarchy = cv2.findContours(maskimgT,cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)#contours为轮廓集，可以计算轮廓的长度、面积等  \n",
    "    #emptyImageTT = np.zeros(maskimgT.shape, np.uint8)\n",
    "    #print(len(contours))\n",
    "\n",
    "\n",
    "    #plt.show() \n",
    "    for cnt in contours:  \n",
    "        #print(len(cnt))\n",
    "        if len(cnt) > pointsTheshold:  \n",
    "            S1=cv2.contourArea(cnt)  \n",
    "            ell=cv2.fitEllipse(cnt)  \n",
    "            S2 =math.pi*ell[1][0]*ell[1][1] \n",
    "            #print(S2)\n",
    "            if S1 > areathreshold and (S1/S2)>0.005 and S1 < 100000:#面积比例，可以更改，根据数据集。。。  \n",
    "                #print(S1,S2,ell)\n",
    "                #cv2.drawContours(emptyImageTT, cnt, -1, (255, 255, 255), 2)\n",
    "                cv2.ellipse(dstimgT, ell,color, 15)\n",
    "                cv2.ellipse(dstimgT, ell,color, cv2.FILLED)\n",
    "\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(60.0,40.0)\n",
    "        plt.subplot(2,1,1),plt.imshow(imgrayT,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(dstimgT,'gray')            \n",
    "    return dstimgT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "path = 'I:/陈宁/对账单/4'\n",
    "filename=\"4 中国银行 - 金_页面_01.jpg\"\n",
    "filepath=os.path.join(path,filename)\n",
    "iproc_obj = imgproc.ImageProc(filepath)\n",
    "img = removeStamp(iproc_obj.gray_img,debug=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "%reload_ext autoreload\n",
    "%autoreload 2\n",
    "\n",
    "canny_low_thresh=150\n",
    "canny_high_thresh=250\n",
    "canny_kernel_size=3\n",
    "hough_rho_res=1\n",
    "hough_theta_res=np.pi/550\n",
    "hough_votes_thresh=490\n",
    "hscale = 10\n",
    "vscale = 10\n",
    "\n",
    "\n",
    "def ocrimgtoexcel(filename,path,hscale = 10,vscale = 10,debug=False ):\n",
    "    print('1：读取文件{}'.format(filename))\n",
    "    filepath=os.path.join(path,filename)\n",
    "    iproc_obj = imgproc.ImageProc(filepath)\n",
    "    print('图像h={} w={}'.format(iproc_obj.input_img.shape[0],iproc_obj.input_img.shape[1]))\n",
    "\n",
    "    print('2：去除椭圆印章')\n",
    "    #img = iproc_obj.removeEllipseStamp(debug=debug)\n",
    "    # if debug:\n",
    "    # plt.gcf().set_size_inches(90,50)\n",
    "    # plt.subplot(1,1,1),plt.imshow(img,'gray')\n",
    "    # plt.show()\n",
    "    print('3：检测水平线和角度')\n",
    "    sum = 0.0\n",
    "    number = 0\n",
    "    lines_hough = iproc_obj.detect_lines(canny_low_thresh=canny_low_thresh,\n",
    "                                         canny_high_thresh=canny_high_thresh,\n",
    "                                         canny_kernel_size=canny_kernel_size,\n",
    "                                         hough_rho_res=1,\n",
    "                                         hough_theta_res=hough_theta_res,\n",
    "                                         hough_votes_thresh=hough_votes_thresh)\n",
    "\n",
    "\n",
    "    img_lines = iproc_obj.draw_lines(orig_img_as_background=True)\n",
    "    print('omit_on_rot_thresh: ',np.pi/10)\n",
    "    theta_rotate = iproc_obj.find_rotation_or_skew2(rot_thresh=0.001, rot_same_dir_thresh=0.1, omit_on_rot_thresh=np.pi/10,only_direction=DIRECTION_HORIZONTAL)\n",
    "    angle = degrees(theta_rotate[1])\n",
    "    print(\"-----方向{} 校正角度 {}\".format(theta_rotate[0],angle))\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(90,50)\n",
    "        plt.subplot(2,1,1),plt.imshow(iproc_obj.gray_img,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(img_lines,'gray')\n",
    "        plt.show()\n",
    "    print('3：水平校正')\n",
    "    rotate_image = iproc_obj.rotate_image(iproc_obj.gray_img,-angle)\n",
    "    print(rotate_image.shape)\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(40,30)\n",
    "        plt.subplot(1,1,1),plt.imshow(rotate_image,'gray')\n",
    "        plt.show()\n",
    "  \n",
    "    print('4：检测表格上下横线')\n",
    "    bordercut = 20\n",
    "    x1= 0+bordercut\n",
    "    y1= 0+bordercut    # 切掉周边，避免干扰\n",
    "    x2= rotate_image.shape[1]-bordercut\n",
    "    y2= rotate_image.shape[0]-bordercut\n",
    "    dt = detectTable(rotate_image[y1:y2, x1:x2])\n",
    "    #thresh_img = cv2.threshold(~rotate_image, 100, 255, cv2.THRESH_BINARY)[1]\n",
    "    imgThresh= cv2.bilateralFilter(rotate_image, 21, 21 * 2, 25 / 2);\n",
    "    imgThresh = cv2.fastNlMeansDenoising(imgThresh, None, 21, 11, 21)\n",
    "    thresh_img = cv2.adaptiveThreshold(\n",
    "        imgThresh, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 45, 9)\n",
    "    h_img = thresh_img.copy()\n",
    "    hscale = hscale\n",
    "    h_size = int(h_img.shape[1]/hscale)\n",
    "\n",
    "    h_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "    h_dashed_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (5, 1))  # 形态学因子\n",
    "    h_dilate_imgT = cv2.dilate(h_img, h_dashed_structure, 1) # 虚线转为实线\n",
    "    h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "    h_dilate_img = cv2.dilate(h_erode_img, h_structure, 1)\n",
    "\n",
    "\n",
    "    v_img = thresh_img.copy()\n",
    "    vscale = vscale\n",
    "    v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "    v_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "    v_dashed_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (1, 3))  # 形态学因子\n",
    "    v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "    v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "    v_dilate_img = cv2.dilate(v_erode_img, v_structure, 1)\n",
    "    mask = h_dilate_img + v_dilate_img\n",
    "    print(h_dilate_img.shape)\n",
    "    print(v_dilate_img.shape)\n",
    "    print(mask.shape)\n",
    "\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(90,50)\n",
    "        plt.subplot(2,1,1),plt.imshow(mask,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(thresh_img,'gray')\n",
    "        plt.show()\n",
    "        \n",
    "\n",
    "    print('5：计算表格上下线坐标')\n",
    "    border =1\n",
    "    dtable = detectTable(rotate_image)\n",
    "    h_threshold = int(rotate_image.shape[0]/8)\n",
    "    v_threshold = int(rotate_image.shape[1]/10)\n",
    "\n",
    "    x_count,x_segmentation = dtable.verticalShadowSplite(v_dilate_img,v_threshold)\n",
    "    y_count,y_segmentation = dtable.horizontalShadowSplite(h_dilate_img,h_threshold)\n",
    "    print(len(x_segmentation),len(y_segmentation))\n",
    "    \n",
    "    #print(len(y_segmentation))\n",
    "    if debug:\n",
    "        emptyImagev=dtable.getShadowimg(rotate_image,x_count,'V')\n",
    "        emptyImageh=dtable.getShadowimg(rotate_image,y_count,'H')\n",
    "        plt.gcf().set_size_inches(60.0,40.0)\n",
    "        plt.subplot(2,1,1),plt.imshow(emptyImagev,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(emptyImageh,'gray')\n",
    "        plt.show()\n",
    "\n",
    "    prerows=dt.getLineCor(rotate_image.shape[0],y_segmentation) \n",
    "    if len(prerows) == 0:\n",
    "        prerows.append(0)\n",
    "        prerows.append(rotate_image.shape[0])\n",
    "    if len(prerows) == 1:\n",
    "        rows[0] = 0\n",
    "        prerows.append(rotate_image.shape[0])\n",
    "\n",
    "    precolums=dt.getLineCor(rotate_image.shape[1],x_segmentation)   \n",
    "    print(precolums)\n",
    "    if len(precolums) == 0:\n",
    "        precolums.append(0)\n",
    "        precolums.append(rotate_image.shape[1])\n",
    "\n",
    "    if len(precolums) == 1:\n",
    "        precolums[0] = 0\n",
    "        precolums.append(rotate_image.shape[1])\n",
    "    #colums=dt.getLineCor(rotate_image.shape[1],x_segmentation)  \n",
    "    x1= precolums[0]+border\n",
    "    y1= prerows[0]+border-(prerows[1]-prerows[0])   # 切掉周边，避免干扰 for \n",
    "    x2= precolums[-1]-border\n",
    "    y2= prerows[-1]-border\n",
    "    print(\"左上角x1={} y1={},右下角x2={} y2={}\".format(x1,y1,x2,y2))\n",
    "    #rotate_image = removeStamp(rotate_image)  #去掉印章\n",
    "    tablerect = rotate_image[y1:y2, x1:x2] #获取表格部分\n",
    "    maskT = mask[y1:y2, x1:x2]\n",
    "    if debug:\n",
    "        print(\"行参考{}列参考{}\".format(prerows,precolums))\n",
    "        print(x_segmentation,y_segmentation)\n",
    "\n",
    "        plt.gcf().set_size_inches(40.0,40.0)\n",
    "        plt.subplot(2,1,1),plt.imshow(tablerect,'gray')\n",
    "        plt.subplot(2,1,2),plt.imshow(maskT,'gray')\n",
    "        plt.show()\n",
    "\n",
    "    print('6：分割前预处理')\n",
    "    # 消除噪音 ，便于分割\n",
    "    print(maskT.shape,tablerect.shape)\n",
    "    tableImgNoborder = cv2.add(maskT,tablerect) # 去掉边界\n",
    "\n",
    "    imgbilateral= cv2.bilateralFilter(tableImgNoborder, 15, 50, 30);   # 双边滤波，去除噪音，边缘不变\n",
    "    meansThresh = cv2.fastNlMeansDenoising(imgbilateral, None, 34, 21, 7) # 中值滤波，去除噪音\n",
    "    thresh_img = cv2.adaptiveThreshold(\n",
    "        meansThresh, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 25, 11) #二值化,通过阈值删除噪音\n",
    "    x_structure = cv2.getStructuringElement(\n",
    "        cv2.MORPH_RECT, (3, 3))\n",
    "    if len(prerows) > 3:\n",
    "        h_erode_img = maskT\n",
    "    else:\n",
    "        h_img = thresh_img.copy()\n",
    "        hscale = hscale\n",
    "        h_size = int(h_img.shape[1]/hscale)\n",
    "        print(h_size)\n",
    "        h_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "\n",
    "        h_erode_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (1, 5))  # 形态学因子\n",
    "        #h_dilate_imgT = cv2.dilate(h_img, h_structure, 1) # 横向膨胀\n",
    "        #h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "        h_MORPH_CLOSE_img=    cv2.morphologyEx(h_img,cv2.MORPH_CLOSE,h_structure)\n",
    "        h_erode_img = cv2.erode(h_MORPH_CLOSE_img, h_erode_structure, 1) \n",
    "\n",
    "    if len(precolums) > 3:\n",
    "        v_erode_img = maskT\n",
    "    else:\n",
    "        v_img = thresh_img.copy()\n",
    "        vscale = vscale\n",
    "        v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "        v_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "        v_erode_structure = cv2.getStructuringElement(\n",
    "            cv2.MORPH_RECT, (15, 15))  # 形态学因子\n",
    "        #v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "        #v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "        v_MORPH_CLOSE_img=    cv2.morphologyEx(v_img,cv2.MORPH_CLOSE,v_structure)\n",
    "        v_erode_img = cv2.morphologyEx(v_MORPH_CLOSE_img, cv2.MORPH_CLOSE,v_erode_structure)\n",
    "        #v_erode_img=    cv2.erode(v_MORPH_CLOSE_img,v_erode_structure)\n",
    "    if debug:\n",
    "        plt.gcf().set_size_inches(40.0,40.0)\n",
    "        plt.subplot(3,1,1),plt.imshow(thresh_img,'gray')\n",
    "        plt.subplot(3,1,2),plt.imshow(h_erode_img,'gray')\n",
    "        plt.subplot(3,1,3),plt.imshow(v_erode_img,'gray')\n",
    "        plt.show()\n",
    "\n",
    "\n",
    "\n",
    "   \n",
    "    print('7：计算行和列分割线')\n",
    "    dt = detectTable(tableImgNoborder)\n",
    "    h_threshold = int(tableImgNoborder.shape[1]/6)\n",
    "    v_threshold = int(tableImgNoborder.shape[0]/10)\n",
    "\n",
    "    x_count,x_segmentation = dt.verticalShadowSplite(v_erode_img,v_threshold)  #垂直投影\n",
    "    y_count,y_segmentation = dt.horizontalShadowSplite(h_erode_img,h_threshold)  #水平投影\n",
    "\n",
    "    rows=dt.getLineCor(tableImgNoborder.shape[0],y_segmentation, False if len(prerows) > 3 else True)   #至少5行\n",
    "    colums=dt.getLineCor(tableImgNoborder.shape[1],x_segmentation, False if len(precolums) > 3 else True)     #至少4列\n",
    "    if len(prerows) <= 3 and len(rows) > 2:\n",
    "        rows[0]=0\n",
    "        rows[-1]=tableImgNoborder.shape[1]\n",
    "    if len(precolums) <= 3 and len(colums) > 2:\n",
    "        colums[0]=0\n",
    "        colums[-1]=tableImgNoborder.shape[1]\n",
    "    if tableImgNoborder.shape[0] - rows[-1] >20:\n",
    "        rows.append(tableImgNoborder.shape[0]-1)\n",
    "    if tableImgNoborder.shape[1] - colums[-1] >20:    \n",
    "        colums.append(tableImgNoborder.shape[1]-1)\n",
    "    print(len(rows),len(colums))\n",
    "    print('rows=',rows)\n",
    "    print('colums=',colums)\n",
    "    if debug:\n",
    "        emptyImagev=dt.getShadowimg(tableImgNoborder,x_count,'V')\n",
    "        emptyImageh=dt.getShadowimg(tableImgNoborder,y_count,'H')\n",
    "        white = (255, 255, 255)\n",
    "        black = (0, 0, 0)\n",
    "        h,w=thresh_img.shape\n",
    "        emptyImage = tableImgNoborder.copy()\n",
    "        for x in colums:\n",
    "            cv2.line(emptyImage, (x, 0), (x, h), black)\n",
    "        for y in rows:\n",
    "\n",
    "            cv2.line(emptyImage, (0, y), (w, y), black)\n",
    "        cv2.imwrite('test.jpg',emptyImage)\n",
    "        plt.gcf().set_size_inches(80.0,60.0)\n",
    "        #plt.subplot(3,1,1),plt.imshow(emptyImagev,'gray')\n",
    "        #plt.subplot(3,1,2),plt.imshow(emptyImageh,'gray')\n",
    "        plt.subplot(3,1,1),plt.imshow(emptyImage,'gray')\n",
    "        plt.show()\n",
    "    \n",
    "    print('8：每个cell进行识别的tablelist') \n",
    "    savename,extension = os.path.splitext(filename)\n",
    "    tempoutpath=os.path.join(path,tempout)\n",
    "    if not os.path.exists(tempoutpath):\n",
    "        os.makedirs(tempoutpath)\n",
    "    savepath = os.path.join(tempoutpath,savename+'.xlsx')      \n",
    "    \n",
    "\n",
    "    tablelist = imgtotable(tableImgNoborder,rows,colums,debug)\n",
    "    print('9：保存文件')       \n",
    "\n",
    "\n",
    "    df=pd.DataFrame(tablelist)\n",
    "\n",
    "    if not os.path.exists(tempoutpath):\n",
    "        os.makedirs(tempoutpath)\n",
    "    savepath = os.path.join(tempoutpath,savename+'.xlsx')\n",
    "    writer = pd.ExcelWriter(savepath)\n",
    "    df.to_excel(writer, sheet_name=savename)\n",
    "    writer.save()\n",
    "    writer.close()\n",
    "    print('10：{}.jpg '.format(savename))\n",
    "    \n",
    "    return tablelist\n",
    " "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "path = 'I:/陈宁/对账单/4'\n",
    "filename=\"4 中国银行 - 金_页面_01.jpg\"\n",
    "ocrimgtoexcel(filename,path,debug=True)\n",
    "print('ok')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "处理 I:/陈宁/对账单/4 目录下图片\n",
      "---- 4 中国银行 - 金_页面_01.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_01.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=3782\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=691,右下角x2=1652 y2=2114\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 9\n",
      "rows= [69, 139, 210, 281, 353, 424, 495, 565, 637, 708, 780, 851, 923, 994, 1066, 1137, 1208, 1280, 1352, 1422]\n",
      "colums= [0, 223, 288, 516, 833, 1216, 1337, 1468, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_01.jpg \n",
      "----4 中国银行 - 金_页面_01.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_02.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_02.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=4748\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 6\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=686,右下角x2=1652 y2=1110\n",
      "6：分割前预处理\n",
      "(424, 1651) (424, 1651)\n",
      "7：计算行和列分割线\n",
      "6 12\n",
      "rows= [70, 141, 213, 284, 354, 423]\n",
      "colums= [0, 219, 284, 379, 511, 638, 686, 829, 1210, 1331, 1463, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_02.jpg \n",
      "----4 中国银行 - 金_页面_02.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_03.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_03.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=1766\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 19\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=690,右下角x2=1652 y2=2042\n",
      "6：分割前预处理\n",
      "(1352, 1651) (1352, 1651)\n",
      "7：计算行和列分割线\n",
      "19 9\n",
      "rows= [69, 139, 211, 282, 354, 424, 496, 566, 638, 709, 780, 851, 923, 995, 1066, 1137, 1209, 1280, 1351]\n",
      "colums= [0, 220, 285, 519, 837, 1214, 1334, 1467, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_03.jpg \n",
      "----4 中国银行 - 金_页面_03.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_04.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_04.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=3254\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2112\n",
      "6：分割前预处理\n",
      "(1424, 1651) (1424, 1651)\n",
      "7：计算行和列分割线\n",
      "20 12\n",
      "rows= [70, 141, 212, 283, 355, 425, 497, 567, 639, 710, 782, 853, 924, 995, 1068, 1139, 1211, 1282, 1355, 1423]\n",
      "colums= [0, 217, 283, 511, 835, 1212, 1331, 1464, 1544, 1565, 1581, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_04.jpg \n",
      "----4 中国银行 - 金_页面_04.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_05.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_05.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=4756\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 19\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2038\n",
      "6：分割前预处理\n",
      "(1350, 1651) (1350, 1651)\n",
      "7：计算行和列分割线\n",
      "19 8\n",
      "rows= [69, 139, 211, 281, 352, 423, 495, 566, 638, 708, 779, 851, 923, 994, 1066, 1137, 1209, 1280, 1349]\n",
      "colums= [0, 218, 283, 518, 830, 1255, 1465, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_05.jpg \n",
      "----4 中国银行 - 金_页面_05.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_06.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_06.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=6186\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=689,右下角x2=1652 y2=2111\n",
      "6：分割前预处理\n",
      "(1422, 1651) (1422, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [69, 139, 211, 282, 354, 425, 495, 566, 638, 709, 780, 851, 923, 994, 1066, 1137, 1209, 1280, 1352, 1421]\n",
      "colums= [0, 215, 281, 513, 832, 1252, 1462, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_06.jpg \n",
      "----4 中国银行 - 金_页面_06.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_07.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_07.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=3252\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 18\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=1967\n",
      "6：分割前预处理\n",
      "(1280, 1651) (1280, 1651)\n",
      "7：计算行和列分割线\n",
      "18 8\n",
      "rows= [70, 141, 212, 282, 353, 425, 497, 567, 639, 710, 782, 852, 924, 995, 1067, 1139, 1210, 1279]\n",
      "colums= [0, 218, 283, 518, 830, 1255, 1466, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_07.jpg \n",
      "----4 中国银行 - 金_页面_07.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_08.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_08.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=684,右下角x2=1652 y2=2108\n",
      "6：分割前预处理\n",
      "(1424, 1651) (1424, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [70, 141, 212, 283, 355, 425, 497, 568, 639, 710, 782, 853, 925, 996, 1068, 1139, 1211, 1282, 1354, 1423]\n",
      "colums= [0, 215, 280, 510, 827, 1252, 1462, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_08.jpg \n",
      "----4 中国银行 - 金_页面_08.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_09.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_09.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=1692\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2111\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 10\n",
      "rows= [70, 141, 212, 283, 354, 425, 497, 568, 640, 710, 782, 853, 924, 995, 1067, 1139, 1211, 1282, 1354, 1422]\n",
      "colums= [0, 218, 282, 512, 766, 894, 1226, 1466, 1564, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_09.jpg \n",
      "----4 中国银行 - 金_页面_09.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_10.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_10.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=2110\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [69, 139, 211, 282, 354, 424, 495, 566, 638, 709, 780, 851, 923, 995, 1067, 1137, 1209, 1280, 1353, 1422]\n",
      "colums= [0, 215, 280, 515, 828, 1252, 1462, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_10.jpg \n",
      "----4 中国银行 - 金_页面_10.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_11.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_11.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=1796\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 19\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=690,右下角x2=1652 y2=2043\n",
      "6：分割前预处理\n",
      "(1353, 1651) (1353, 1651)\n",
      "7：计算行和列分割线\n",
      "19 8\n",
      "rows= [70, 141, 213, 283, 354, 425, 497, 568, 639, 710, 783, 853, 925, 995, 1068, 1139, 1211, 1282, 1352]\n",
      "colums= [0, 220, 285, 514, 832, 1257, 1467, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_11.jpg \n",
      "----4 中国银行 - 金_页面_11.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_12.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_12.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=4820\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=2110\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 9\n",
      "rows= [69, 139, 211, 282, 354, 424, 496, 566, 638, 709, 781, 852, 924, 995, 1066, 1137, 1209, 1281, 1353, 1422]\n",
      "colums= [0, 220, 285, 514, 833, 1218, 1334, 1467, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_12.jpg \n",
      "----4 中国银行 - 金_页面_12.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_13.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_13.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=684,右下角x2=1652 y2=2108\n",
      "6：分割前预处理\n",
      "(1424, 1651) (1424, 1651)\n",
      "7：计算行和列分割线\n",
      "20 9\n",
      "rows= [69, 141, 212, 282, 353, 424, 497, 567, 639, 710, 782, 852, 924, 995, 1068, 1139, 1211, 1281, 1353, 1423]\n",
      "colums= [0, 214, 279, 507, 826, 1232, 1463, 1542, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_13.jpg \n",
      "----4 中国银行 - 金_页面_13.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_14.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_14.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2111\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 9\n",
      "rows= [69, 139, 211, 282, 353, 424, 495, 566, 638, 708, 780, 851, 923, 994, 1066, 1137, 1209, 1280, 1352, 1422]\n",
      "colums= [0, 215, 280, 509, 744, 868, 1223, 1463, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_14.jpg \n",
      "----4 中国银行 - 金_页面_14.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_15.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_15.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 18\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=1969\n",
      "6：分割前预处理\n",
      "(1281, 1651) (1281, 1651)\n",
      "7：计算行和列分割线\n",
      "18 8\n",
      "rows= [70, 141, 212, 283, 354, 425, 496, 567, 639, 710, 782, 852, 924, 995, 1067, 1138, 1210, 1280]\n",
      "colums= [0, 216, 281, 509, 833, 1251, 1463, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_15.jpg \n",
      "----4 中国银行 - 金_页面_15.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_16.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_16.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2113\n",
      "6：分割前预处理\n",
      "(1425, 1651) (1425, 1651)\n",
      "7：计算行和列分割线\n",
      "20 10\n",
      "rows= [70, 141, 213, 283, 354, 426, 498, 568, 640, 710, 782, 853, 925, 996, 1069, 1139, 1211, 1282, 1354, 1424]\n",
      "colums= [0, 217, 282, 510, 835, 1254, 1464, 1545, 1565, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_16.jpg \n",
      "----4 中国银行 - 金_页面_16.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_17.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_17.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=1740\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2111\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [69, 139, 211, 282, 354, 424, 496, 566, 638, 709, 781, 852, 924, 995, 1066, 1137, 1210, 1281, 1353, 1422]\n",
      "colums= [0, 220, 285, 514, 837, 1228, 1468, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_17.jpg \n",
      "----4 中国银行 - 金_页面_17.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_18.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_18.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=7730\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 7\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=685,右下角x2=1652 y2=1181\n",
      "6：分割前预处理\n",
      "(496, 1651) (496, 1651)\n",
      "7：计算行和列分割线\n",
      "7 10\n",
      "rows= [70, 141, 212, 283, 354, 425, 495]\n",
      "colums= [0, 220, 286, 517, 652, 700, 724, 1052, 1467, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_18.jpg \n",
      "----4 中国银行 - 金_页面_18.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_19.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_19.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=685,右下角x2=1652 y2=2108\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [69, 139, 211, 281, 353, 424, 496, 566, 637, 708, 781, 852, 923, 994, 1066, 1137, 1209, 1280, 1352, 1422]\n",
      "colums= [0, 215, 279, 509, 1043, 1462, 1540, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_19.jpg \n",
      "----4 中国银行 - 金_页面_19.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_20.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_20.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=683,右下角x2=1652 y2=2108\n",
      "6：分割前预处理\n",
      "(1425, 1651) (1425, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [70, 141, 213, 284, 356, 425, 497, 569, 641, 711, 783, 854, 926, 997, 1069, 1140, 1212, 1283, 1355, 1424]\n",
      "colums= [0, 216, 281, 551, 1049, 1464, 1550, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_20.jpg \n",
      "----4 中国银行 - 金_页面_20.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_21.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_21.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=5202\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 16\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=691,右下角x2=1652 y2=1827\n",
      "6：分割前预处理\n",
      "(1136, 1651) (1136, 1651)\n",
      "7：计算行和列分割线\n",
      "16 7\n",
      "rows= [69, 139, 211, 282, 354, 424, 495, 566, 638, 709, 781, 852, 924, 995, 1066, 1135]\n",
      "colums= [0, 215, 281, 550, 1044, 1463, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_21.jpg \n",
      "----4 中国银行 - 金_页面_21.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_22.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_22.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=690,右下角x2=1652 y2=2113\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 12\n",
      "rows= [69, 139, 211, 281, 353, 423, 495, 566, 637, 709, 780, 851, 923, 994, 1066, 1138, 1209, 1280, 1353, 1422]\n",
      "colums= [0, 214, 279, 501, 513, 525, 567, 749, 784, 807, 1123, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： RECT:[69:501,139:513]\n",
      "列4： RECT:[69:513,139:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行1： 列0： 列1： 列2： 列3： RECT:[139:501,211:513]\n",
      "列4： RECT:[139:513,211:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行2： 列0： 列1： 列2： 列3： RECT:[211:501,281:513]\n",
      "列4： RECT:[211:513,281:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行3： 列0： 列1： 列2： 列3： RECT:[281:501,353:513]\n",
      "列4： RECT:[281:513,353:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行4： 列0： 列1： 列2： 列3： RECT:[353:501,423:513]\n",
      "列4： RECT:[353:513,423:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行5： 列0： 列1： 列2： 列3： RECT:[423:501,495:513]\n",
      "列4： RECT:[423:513,495:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行6： 列0： 列1： 列2： 列3： RECT:[495:501,566:513]\n",
      "列4： RECT:[495:513,566:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行7： 列0： 列1： 列2： 列3： RECT:[566:501,637:513]\n",
      "列4： RECT:[566:513,637:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行8： 列0： 列1： 列2： 列3： RECT:[637:501,709:513]\n",
      "列4： RECT:[637:513,709:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行9： 列0： 列1： 列2： 列3： RECT:[709:501,780:513]\n",
      "列4： RECT:[709:513,780:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行10： 列0： 列1： 列2： 列3： RECT:[780:501,851:513]\n",
      "列4： RECT:[780:513,851:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行11： 列0： 列1： 列2： 列3： RECT:[851:501,923:513]\n",
      "列4： RECT:[851:513,923:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行12： 列0： 列1： 列2： 列3： RECT:[923:501,994:513]\n",
      "列4： RECT:[923:513,994:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行13： 列0： 列1： 列2： 列3： RECT:[994:501,1066:513]\n",
      "列4： RECT:[994:513,1066:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行14： 列0： 列1： 列2： 列3： RECT:[1066:501,1138:513]\n",
      "列4： RECT:[1066:513,1138:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行15： 列0： 列1： 列2： 列3： RECT:[1138:501,1209:513]\n",
      "列4： RECT:[1138:513,1209:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行16： 列0： 列1： 列2： 列3： RECT:[1209:501,1280:513]\n",
      "列4： RECT:[1209:513,1280:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行17： 列0： 列1： 列2： 列3： RECT:[1280:501,1353:513]\n",
      "列4： RECT:[1280:513,1353:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "行18： 列0： 列1： 列2： 列3： RECT:[1353:501,1422:513]\n",
      "列4： RECT:[1353:513,1422:525]\n",
      "列5： 列6： 列7： 列8： 列9： 列10：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_22.jpg \n",
      "----4 中国银行 - 金_页面_22.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_23.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_23.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=686,右下角x2=1652 y2=2111\n",
      "6：分割前预处理\n",
      "(1425, 1651) (1425, 1651)\n",
      "7：计算行和列分割线\n",
      "20 11\n",
      "rows= [70, 141, 212, 283, 355, 425, 498, 568, 640, 710, 782, 853, 925, 996, 1068, 1140, 1211, 1282, 1354, 1424]\n",
      "colums= [0, 213, 279, 555, 766, 904, 1012, 1089, 1244, 1462, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7： 列8： 列9：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_23.jpg \n",
      "----4 中国银行 - 金_页面_23.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_24.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_24.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=6894\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 11\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=689,右下角x2=1652 y2=1468\n",
      "6：分割前预处理\n",
      "(779, 1651) (779, 1651)\n",
      "7：计算行和列分割线\n",
      "11 7\n",
      "rows= [69, 139, 211, 282, 354, 423, 495, 566, 638, 709, 778]\n",
      "colums= [0, 215, 280, 554, 1059, 1462, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_24.jpg \n",
      "----4 中国银行 - 金_页面_24.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_25.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_25.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=2354\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=2112\n",
      "6：分割前预处理\n",
      "(1425, 1651) (1425, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [70, 141, 213, 283, 354, 425, 497, 568, 639, 711, 783, 853, 925, 996, 1068, 1140, 1212, 1282, 1354, 1424]\n",
      "colums= [0, 223, 288, 564, 1056, 1470, 1564, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_25.jpg \n",
      "----4 中国银行 - 金_页面_25.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_26.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_26.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=1920\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2113\n",
      "6：分割前预处理\n",
      "(1425, 1651) (1425, 1651)\n",
      "7：计算行和列分割线\n",
      "20 7\n",
      "rows= [70, 141, 212, 283, 355, 425, 498, 568, 640, 710, 782, 853, 926, 997, 1068, 1139, 1211, 1283, 1355, 1424]\n",
      "colums= [0, 219, 283, 553, 1047, 1467, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_26.jpg \n",
      "----4 中国银行 - 金_页面_26.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_27.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_27.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=2112\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=691,右下角x2=1652 y2=2114\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [69, 139, 211, 282, 353, 424, 495, 566, 638, 709, 781, 852, 923, 995, 1067, 1138, 1210, 1281, 1354, 1422]\n",
      "colums= [0, 218, 283, 558, 849, 1224, 1464, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_27.jpg \n",
      "----4 中国银行 - 金_页面_27.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_28.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_28.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=6692\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 2\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=827\n",
      "6：分割前预处理\n",
      "(140, 1651) (140, 1651)\n",
      "165\n",
      "7：计算行和列分割线\n",
      "3 13\n",
      "rows= [0, 57, 1651]\n",
      "colums= [0, 217, 283, 374, 382, 510, 626, 635, 677, 725, 1061, 1463, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： RECT:[0:374,57:382]\n",
      "列4： 列5： 列6： RECT:[0:626,57:635]\n",
      "列7： 列8： 列9： 列10： 列11：  \n",
      "行1： 列0： 列1： 列2： 列3： RECT:[57:374,1651:382]\n",
      "列4： 列5： 列6： RECT:[57:626,1651:635]\n",
      "列7： 列8： 列9： 列10： 列11：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_28.jpg \n",
      "----4 中国银行 - 金_页面_28.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_29.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_29.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=2112\n",
      "6：分割前预处理\n",
      "(1425, 1651) (1425, 1651)\n",
      "7：计算行和列分割线\n",
      "20 9\n",
      "rows= [70, 141, 212, 283, 354, 425, 497, 568, 640, 711, 782, 853, 925, 997, 1068, 1139, 1212, 1283, 1354, 1424]\n",
      "colums= [0, 215, 280, 557, 744, 1070, 1462, 1554, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6： 列7：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_29.jpg \n",
      "----4 中国银行 - 金_页面_29.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_30.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_30.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2112\n",
      "6：分割前预处理\n",
      "(1424, 1651) (1424, 1651)\n",
      "7：计算行和列分割线\n",
      "20 7\n",
      "rows= [69, 139, 211, 282, 354, 424, 496, 566, 638, 710, 781, 852, 924, 995, 1067, 1138, 1210, 1282, 1354, 1423]\n",
      "colums= [0, 216, 281, 556, 1044, 1464, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_30.jpg \n",
      "----4 中国银行 - 金_页面_30.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_31.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_31.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=4374\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 6\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=1112\n",
      "6：分割前预处理\n",
      "(424, 1651) (424, 1651)\n",
      "7：计算行和列分割线\n",
      "6 9\n",
      "rows= [70, 141, 213, 283, 354, 423]\n",
      "colums= [0, 220, 284, 518, 640, 649, 1046, 1466, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： RECT:[70:640,141:649]\n",
      "列5： 列6： 列7：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： RECT:[141:640,213:649]\n",
      "列5： 列6： 列7：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： RECT:[213:640,283:649]\n",
      "列5： 列6： 列7：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： RECT:[283:640,354:649]\n",
      "列5： 列6： 列7：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： RECT:[354:640,423:649]\n",
      "列5： 列6： 列7：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_31.jpg \n",
      "----4 中国银行 - 金_页面_31.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_32.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_32.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=2111\n",
      "6：分割前预处理\n",
      "(1424, 1651) (1424, 1651)\n",
      "7：计算行和列分割线\n",
      "20 7\n",
      "rows= [69, 139, 211, 282, 354, 424, 496, 567, 639, 709, 781, 852, 924, 995, 1066, 1138, 1210, 1281, 1353, 1423]\n",
      "colums= [0, 217, 281, 558, 1051, 1465, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_32.jpg \n",
      "----4 中国银行 - 金_页面_32.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_33.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_33.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "4.371139006309477e-08 None False False\n",
      "-----方向sx 校正角度 0.0\n",
      "3：水平校正\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=686,右下角x2=1652 y2=2110\n",
      "6：分割前预处理\n",
      "(1424, 1651) (1424, 1651)\n",
      "7：计算行和列分割线\n",
      "20 7\n",
      "rows= [70, 141, 213, 283, 355, 426, 497, 567, 640, 711, 783, 853, 925, 996, 1068, 1139, 1211, 1283, 1355, 1423]\n",
      "colums= [0, 215, 280, 556, 1048, 1463, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_33.jpg \n",
      "----4 中国银行 - 金_页面_33.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_34.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_34.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=5626\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=2114\n",
      "6：分割前预处理\n",
      "(1426, 1651) (1426, 1651)\n",
      "7：计算行和列分割线\n",
      "20 7\n",
      "rows= [70, 141, 212, 283, 354, 425, 498, 569, 640, 710, 782, 853, 925, 996, 1069, 1140, 1212, 1282, 1355, 1425]\n",
      "colums= [0, 217, 281, 552, 1046, 1465, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_34.jpg \n",
      "----4 中国银行 - 金_页面_34.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_35.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_35.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=3734\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 9\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=688,右下角x2=1652 y2=1327\n",
      "6：分割前预处理\n",
      "(639, 1651) (639, 1651)\n",
      "7：计算行和列分割线\n",
      "9 8\n",
      "rows= [70, 141, 213, 284, 356, 426, 498, 568, 638]\n",
      "colums= [0, 216, 282, 551, 686, 1045, 1464, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_35.jpg \n",
      "----4 中国银行 - 金_页面_35.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_36.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_36.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.002856000265802905 None True False\n",
      "-----方向sx 校正角度 0.16363676151874776\n",
      "3：水平校正\n",
      "points.length()=1696\n",
      "校正角度-0.16363676151874776--0.16363676151874776\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=687,右下角x2=1652 y2=2111\n",
      "6：分割前预处理\n",
      "(1424, 1651) (1424, 1651)\n",
      "7：计算行和列分割线\n",
      "20 8\n",
      "rows= [69, 139, 211, 282, 354, 424, 496, 567, 639, 709, 781, 852, 925, 995, 1067, 1138, 1210, 1281, 1354, 1423]\n",
      "colums= [0, 218, 283, 561, 1046, 1466, 1564, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5： 列6：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_36.jpg \n",
      "----4 中国银行 - 金_页面_36.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_37.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_37.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=1790\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 20\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=689,右下角x2=1652 y2=2112\n",
      "6：分割前预处理\n",
      "(1423, 1651) (1423, 1651)\n",
      "7：计算行和列分割线\n",
      "20 7\n",
      "rows= [68, 139, 211, 281, 353, 424, 495, 565, 638, 709, 781, 852, 923, 994, 1066, 1137, 1209, 1281, 1354, 1422]\n",
      "colums= [0, 220, 285, 556, 1048, 1468, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行14： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行15： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行16： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行17： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行18： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_37.jpg \n",
      "----4 中国银行 - 金_页面_37.jpg is complete--- \n",
      "---- 4 中国银行 - 金_页面_38.jpg is start---\n",
      "1：读取文件4 中国银行 - 金_页面_38.jpg\n",
      "图像h=2338 w=1653\n",
      "2：去除椭圆印章\n",
      "3：检测水平线和角度\n",
      "omit_on_rot_thresh:  0.3141592653589793\n",
      "0.005711956820215747 None True False\n",
      "-----方向sx 校正角度 0.3272710185593282\n",
      "3：水平校正\n",
      "points.length()=6288\n",
      "校正角度-0.3272710185593282--0.3272710185593282\n",
      "(2338, 1653)\n",
      "4：检测表格上下横线\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "(2338, 1653)\n",
      "5：计算表格上下线坐标\n",
      "0 15\n",
      "[0, 1653]\n",
      "左上角x1=1 y1=682,右下角x2=1652 y2=1749\n",
      "6：分割前预处理\n",
      "(1067, 1651) (1067, 1651)\n",
      "7：计算行和列分割线\n",
      "15 7\n",
      "rows= [71, 143, 214, 284, 355, 426, 498, 569, 641, 711, 783, 853, 925, 996, 1066]\n",
      "colums= [0, 218, 285, 554, 1047, 1467, 1651]\n",
      "8：每个cell进行识别的tablelist\n",
      "行0： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行1： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行2： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行3： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行4： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行5： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行6： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行7： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行8： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行9： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行10： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行11： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行12： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "行13： 列0： 列1： 列2： 列3： 列4： 列5：  \n",
      "9：保存文件\n",
      "10：4 中国银行 - 金_页面_38.jpg \n",
      "----4 中国银行 - 金_页面_38.jpg is complete--- \n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "\n",
    "fpathe = 'I:/陈宁/对账单/4'\n",
    "print(\"处理 {} 目录下图片\".format(fpathe))\n",
    "writer = pd.ExcelWriter(os.path.join(fpathe,'allpages.xlsx'))\n",
    "all_tablelist = []\n",
    "for fpath,dirs,fs in os.walk(fpathe):\n",
    "    \n",
    "    for file in fs:\n",
    "        fname,extension = os.path.splitext(file)\n",
    "        \n",
    "        if extension != '.jpg':\n",
    "            continue\n",
    "        print(\"---- {} is start---\".format(file))\n",
    "        tablelist = ocrimgtoexcel(file,fpath,debug=False)\n",
    "        all_tablelist.append(['No {} page'.format(fname)])\n",
    "        all_tablelist.extend(tablelist)\n",
    "        \n",
    "        print(\"----{} is complete--- \".format(file))\n",
    "sheet_data=pd.DataFrame(all_tablelist)\n",
    "sheet_data.to_excel(writer, sheet_name=fname)\n",
    "writer.save()\n",
    "writer.close()  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "debug = True\n",
    "path = 'j:/icbc/'\n",
    "filename=\"2.jpg\"\n",
    "\n",
    "print('1：读取文件')\n",
    "filepath=os.path.join(path,filename)\n",
    "img = cv2.imread(filepath,0)\n",
    "# create a CLAHE object (Arguments are optional).\n",
    "clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8,8))\n",
    "cl1 = clahe.apply(img)\n",
    "sigma = 1; threshold = 3; amount = 1\n",
    "blurred=cv2.GaussianBlur(cl1,(0,0),1,None,1)\n",
    "#blurred1 = cv2.adaptiveThreshold(\n",
    "#    blurred, 255, cv2.ADAPTIVE_THRESH_MEAN_C, cv2.THRESH_BINARY, 15, -2)\n",
    "lowContrastMask = abs(cl1 - blurred) < threshold\n",
    "sharpened = blurred*(1+amount) + blurred*(-amount)\n",
    "image=cv2.bitwise_or(sharpened.astype(np.uint8),lowContrastMask.astype(np.uint8))\n",
    "plt.gcf().set_size_inches(50.0,60.0)\n",
    "plt.subplot(2,1,1),plt.imshow(blurred,'gray')\n",
    "plt.subplot(2,1,2),plt.imshow(image,'gray')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "hist,bins = np.histogram(img.flatten(),256,[0,256])\n",
    "cdf = hist.cumsum()\n",
    "cdf_normalized = cdf * float(hist.max()) / cdf.max()\n",
    "plt.plot(cdf_normalized, color = 'b')\n",
    "plt.hist(img.flatten(),256,[0,256], color = 'r')\n",
    "plt.xlim([0,256])\n",
    "plt.legend(('cdf','histogram'), loc = 'upper left')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "debug = True\n",
    "\n",
    "path = 'I:/陈宁/对账单/2'\n",
    "filename=\"2_页面_01.jpg\"\n",
    "\n",
    "print('1：读取文件')\n",
    "filepath=os.path.join(path,filename)\n",
    "iproc_obj = imgproc.ImageProc(filepath)\n",
    "thresh_img = cv2.adaptiveThreshold(\n",
    "    iproc_obj.gray_img, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 25, 11) #二值化,通过阈值删除噪音\n",
    "hscale = 10\n",
    "\n",
    "h_img = thresh_img.copy()\n",
    "h_size = int(h_img.shape[1]/hscale)\n",
    "x_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (3, 3))\n",
    "\n",
    "\n",
    "\n",
    "h_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "\n",
    "h_erode_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, 5))  # 形态学因子\n",
    "#h_dilate_imgT = cv2.dilate(h_img, h_structure, 1) # 横向膨胀\n",
    "#h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "h_MORPH_CLOSE_img=    cv2.morphologyEx(h_img,cv2.MORPH_CLOSE,h_structure)\n",
    "h_erode_img = cv2.erode(h_MORPH_CLOSE_img, h_erode_structure, 1) \n",
    "\n",
    "\n",
    "v_img = thresh_img.copy()\n",
    "vscale = 10\n",
    "v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "v_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "v_erode_structure = cv2.getStructuringElement(    imgThresh = cv2.fastNlMeansDenoising(rotate_image, None, 21, 11, 21)\n",
    "    #imgThresh = cv2.fastNlMeansDenoisingColored(rotate_image, None, 10, 10, 7, 21)\n",
    " # 形态学因子\n",
    "#v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "#v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "v_MORPH_CLOSE_img=    cv2.morphologyEx(v_img,cv2.MORPH_CLOSE,v_structure)\n",
    "#v_erode_img = cv2.erode(v_MORPH_CLOSE_img, v_erode_structure, 1)\n",
    "v_erode_img=    cv2.morphologyEx(v_MORPH_CLOSE_img,cv2.MORPH_CLOSE,v_erode_structure)\n",
    "if debug:\n",
    "    plt.gcf().set_size_inches(40.0,50.0)\n",
    "    plt.subplot(3,1,1),plt.imshow(thresh_img,'gray')\n",
    "    plt.subplot(3,1,2),plt.imshow(h_erode_img,'gray')\n",
    "    plt.subplot(3,1,3),plt.imshow(v_erode_img,'gray')\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "debug = True\n",
    "\n",
    "path = 'I:/陈宁/对账单/2'\n",
    "filename=\"2_页面_01.jpg\"\n",
    "\n",
    "print('1：读取文件')\n",
    "filepath=os.path.join(path,filename)\n",
    "iproc_obj = imgproc.ImageProc(filepath)\n",
    "thresh_img = cv2.adaptiveThreshold(\n",
    "    iproc_obj.gray_img, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY_INV, 45, 9)\n",
    "h_img = thresh_img.copy()\n",
    "hscale = hscale\n",
    "h_size = int(h_img.shape[1]/hscale)\n",
    "\n",
    "h_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (h_size, 1))  # 形态学因子\n",
    "h_dashed_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (5, 1))  # 形态学因子\n",
    "h_dilate_imgT = cv2.dilate(h_img, h_dashed_structure, 1) # 虚线转为实线\n",
    "h_erode_img = cv2.erode(h_dilate_imgT, h_structure, 1) #腐蚀掉非水平的对象\n",
    "h_dilate_img = cv2.dilate(h_erode_img, h_structure, 1)\n",
    "\n",
    "\n",
    "v_img = thresh_img.copy()\n",
    "vscale = vscale\n",
    "v_size = int(v_img.shape[0]/vscale)\n",
    "\n",
    "v_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, v_size))  # 形态学因子\n",
    "v_dashed_structure = cv2.getStructuringElement(\n",
    "    cv2.MORPH_RECT, (1, 1))  # 形态学因子\n",
    "v_dilate_imgT = cv2.dilate(v_img, v_dashed_structure, 1) # 虚线转为实线\n",
    "v_erode_img = cv2.erode(v_dilate_imgT, v_structure, 1) #腐蚀掉非水平的对象\n",
    "v_dilate_img = cv2.dilate(v_erode_img, v_structure, 1)\n",
    "\n",
    "if debug:\n",
    "    plt.gcf().set_size_inches(40.0,50.0)\n",
    "    plt.subplot(3,1,1),plt.imshow(thresh_img,'gray')\n",
    "    plt.subplot(3,1,2),plt.imshow(h_dilate_img,'gray')\n",
    "    plt.subplot(3,1,3),plt.imshow(v_dilate_img,'gray')\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "img = cv2.imread(filepath,0)\n",
    "equ = cv2.equalizeHist(img)\n",
    "res = np.hstack((img,equ)) #stacking images side-by-side\n",
    "plt.gcf().set_size_inches(60.0,40.0)\n",
    "plt.subplot(2,1,1),plt.imshow(img,'gray')\n",
    "plt.subplot(2,1,2),plt.imshow(equ,'gray')\n",
    "plt.show()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
